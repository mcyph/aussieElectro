{"version":3,"sources":["components/StoryPanel.js","components/MapVisualization.js","components/StackedBarChart.js","components/StackedBar.js","components/NavMenuItem.js","components/NavMenuTypeItem.js","components/ScrollyTeller.js","App.js","index.js","AUSdata/yearDistribution.csv"],"names":["StoryPanel","m_actionFilter","state","visible","id","props","anchorname","paragraphs","headerHandleChange","event","isIntersecting","activeID","app","setActiveID","setState","res","i","this","length","push","content","text","actionFilter","className","onChange","threshold","title","map","paragraph","key","filter","Component","StoryParagraph","m_firedAction","m_statusChanged","m_filterArray","paragraphChange","handleScroll","bind","window","removeEventListener","topOffset","ReactDOM","findDOMNode","getBoundingClientRect","top","bottomOffset","bottom","highlighted","action","objects","addEventListener","ReactHtmlParser","MapVisualization","m_filterStartYear","m_filterEndYear","m_filterType","m_initiated","self","grump","m_colors","currentYear","activeYear","rawtypes","types","zoomlevel","getFuel","type","fuelDetail","roundToOne","capacity","Math","round","mapboxgl","accessToken","Map","container","style","zoom","center","coalData","solarData","currentData","on","addSource","data","cluster","clusterMaxZoom","clusterRadius","addLayer","source","paint","property","stops","value","base","tooltip","Marker","tooltipContainer","offset","setLngLat","addTo","e","lngLat","features","getCanvas","cursor","drawPopup","getZoom","show","color","name","open","decom","type2","render","React","createElement","PopupContent","unmountComponentAtNode","prevState","updateFilters","active","init","document","o","properties","site","yearOpen","yearEnd","plantColor","setTooltip","filtertype","isStyleLoaded","setFilter","debug","height","ref","el","mapContainer","undefined","StackedBarChart","labels","datasets","label","backgroundColor","percentages","console","log","newObj","percentage","width","options","tooltips","displayColors","callbacks","tooltipItem","datasetIndex","yLabel","scales","xAxes","stacked","gridLines","display","yAxes","position","ticks","beginAtZero","max","stepSize","layout","padding","left","responsive","maintainAspectRatio","legend","PureComponent","StackedBar","NavMenuItem","activeId","selector","alignToTop","NavMenuTypeItem","handleClick","onClickA","onClick","ScrollyTeller","m_debug","m_percentageCalcs","updateDimensions","innerWidth","innerHeight","panelHeight","sections","panelChanged","GetNewPercentages","year","vals","prepPercentages","row","sum","arr","Coal","parseFloat","Solar","Solar2","Gas","Waste","Hydro","Wind","isNaN","toFixed","Year","UNSAFE_componentWillMount","d3","stackedData","then","val","postcode","dataSolar","obj","sectiondata","renderparagraphs","createPanelContent","j","gValue","trunc","allPanels","setActiveMulti","setActive","ttype","setActiveName","toggleActive","result","feature","replace","url","actions","highlight","k","keywords","cap","lower","c","toUpperCase","section","dataCoal","App","getElementById","module","exports"],"mappings":"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","file":"static/js/main.d7fd5af3.chunk.js","sourcesContent":["import React, { Component } from 'react';\nimport ReactDOM from 'react-dom'\nimport Observer from '@researchgate/react-intersection-observer';\nimport ReactHtmlParser from 'react-html-parser';\n\nexport default class StoryPanel extends Component {\n  //a storypanel is visible whenit enters the viewport until another enters.\n  m_actionFilter = null\n  state = {\n    visible: true,\n    id: this.props.id,\n    anchorname: this.props.anchorname,\n    paragraphs: []\n  };\n\n  headerHandleChange = event => {\n\n    if (event.isIntersecting && this.props.id !== this.props.activeID) {  //this element scrolled into view\n      this.props.app.setActiveID(this.props.id)\n    }\n\n    this.setState({\n      visible: this.props.id === this.props.activeID\n\n    });\n  };\n\n  componentDidMount() {\n    var res = [];\n    for (var i = 0; i < this.props.paragraphs.length; i++) {\n      res.push(\n        { \"text\": this.props.paragraphs[i].props.content.text, \"filter\": this.props.paragraphs[i].props.actionFilter }\n      )\n\n     \n\n      this.setState({\n        paragraphs: res\n      })\n    }\n  }\n  render() {\n\n    return (\n      <section id={\"section_\" + this.state.id} className={`storyPanelSection ${this.state.visible && this.state.id === this.props.activeID ? 'activePanel' : 'inactivePanel'}`} >\n        <Observer onChange={this.headerHandleChange}\n          threshold={1}\n        >\n\n          <h1 id={this.props.anchorname} className={`sticky sectiontitle`}>{this.props.title}</h1>\n        </Observer>\n\n        <div id={this.props.anchorname + \"_id\"} className=\"panelcontent\">\n          {this.state.paragraphs.map(\n            (paragraph, i) =>\n              <StoryParagraph\n                key={this.state.anchorname + \"_id_p\" + i}\n                id={this.state.anchorname + \"_id_p\" + i}\n                paragraph={paragraph.text}\n                actionFilter={paragraph.filter}\n\n              />\n          )}\n        </div>\n\n      </section>\n\n    )\n  }\n}\n\nclass StoryParagraph extends Component {\n\n\n  m_firedAction = false\n  m_statusChanged= false\n  m_filterArray = [\"any\", []]\n  state = {\n    id: this.props.id,\n    visible: false\n  }\n\n  constructor(props) {\n    super(props);\n    this.handleScroll = this.handleScroll.bind(this);\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('scroll', this.handleScroll);\n  };\n\n  handleScroll(event) {\n    //if the element is visible we check where it is on the screen, and highlight it when it enters a threshold, dehighlight when it exits.\n    if (this.state.visible) {\n      var topOffset = ReactDOM.findDOMNode(this).getBoundingClientRect().top\n      var bottomOffset = ReactDOM.findDOMNode(this).getBoundingClientRect().bottom\n      if(!this.m_firedAction){\n        if(this.state.highlighted){\n          if (this.props.actionFilter) { //if this has any actions supplied\n         \n            this.props.actionFilter.action( this.props.actionFilter.objects,true)\n         //   this.m_mapFunctions.setFilterTypeString(this.m_filterArray)\n           //TODO HERE this.props.actionFilter.action\n          }\n          this.m_firedAction = true;\n        } else {\n          if (this.props.actionFilter) {\n          \n            this.props.actionFilter.action(null,true)\n           // this.m_mapFunctions.showAllTypes()\n            this.m_firedAction = true;\n          }\n        }\n      }\n      if ((topOffset > 150 && topOffset < 300) || (topOffset < 150 && topOffset > 0 && bottomOffset > 300)) {\n        //if this paragraph has anactionFilter to it, apply it!\n        if(!this.state.highlighted){\n          this.setState({\n            highlighted: true\n          })\n          this.m_firedAction = false\n        } \n         \n        \n      } else {\n \n        if(this.state.highlighted){\n          //visible should update...\n          this.setState({\n            highlighted: false\n          })\n          //deactivate filter if thereisonw\n          this.m_firedAction = false\n        }\n        \n      }\n    }\n  }\n\n  componentDidMount() {\n    window.addEventListener('scroll', this.handleScroll);\n\n    //construct the filter if there is one\n    /*if (this.props.actionFilter) {\n      this.m_filterArray = [\"any\"]\n      //create the filter syntax fromthe actionFilter provided\n      for (var i = 0; i < this.props.actionFilter.types.length; i++) {\n        this.m_filterArray.push([\"==\", [\"get\", \"type\"], this.props.actionFilter.types[i]])\n      }\n      \n     \n    }*/\n  }\n\n  //gets called when the element intersects with Observer\n  paragraphChange = event => {\n    this.setState({\n      visible: event.isIntersecting\n    })\n  \n  }\n\n  render() {\n    return (\n      <Observer\n        onChange={this.paragraphChange}\n      >\n        <p\n          className={`scrolltext ${this.state.highlighted ? \"active\" : \"\"}`}\n          id={this.props.id}>\n          {ReactHtmlParser(this.props.paragraph)}\n     \n        </p>\n      </Observer>\n    )\n  }\n}","import mapboxgl from 'mapbox-gl'\nimport React, { Component } from 'react';\nimport ReactDOM from 'react-dom'\n\nexport default class MapVisualization extends Component {\n\n    // set to 2017 initially despite play preview or you get a bug when using the type dropdown\n    m_filterStartYear = ['<=', ['number', ['get', 'yearStart']], 2000]\n    m_filterEndYear = ['>=', ['number', ['get', 'yearEnd']], 2000]\n    m_filterType = ['!=', ['string', ['get', 'type']], 'placeholder']\n\n    m_initiated = false\n    map = null\n\n    app = null\n    tooltipContainer\n    popup\n    self = null\n    grump = null\n    m_colors = {\n        \"Coal\": \"#91908d\",\n        \"Storage\": \"#4e80e5\",\n        \"Solar\": \"#a18600\",\n        \"Hydro\": \"#43cfef\",\n        \"Wind\": \"#00a98e\",\n        \"Biomass\": \"#A7B734\",\n        \"Waste\": \"#6b4b06\",\n        \"Solar2\": \"#ea545c\",\n        \"Gas\": \"#cc9b7a\"\n    }\n\n    state = {\n\n        currentYear: this.props.activeYear,\n        rawtypes: this.props.types,\n        zoomlevel: 0\n    }\n\n\n    init() {\n        if (!this.m_initiated) {\n            mapboxgl.accessToken = \"pk.eyJ1IjoiZGF2ZW0xMTIyMzMiLCJhIjoiY2tsYnU0cjZiMHU2MjJ1cDI1cnRicXU4byJ9.hTkSY8W2vyxK0o0tezD5Mg\"\n            this.map = new mapboxgl.Map({\n                container: \"map\",\n                style: \"mapbox://styles/mapbox/streets-v11\",\n                zoom: [4],\n                center: [140.7751, -38.2744]\n            })\n\n           \n            // const filterType = ['!=', ['string', ['get', 'technology']], 'Battery (Discharging)'];\n            var coalData = this.props.coalData;//geojson.parse(data, {Point: ['latitude','longitude']})\n            var solarData = this.props.solarData;\n            var currentData = this.props.currentData;\n            //  console.log(geojsondata)\n            this.map.on('load', () => {\n\n                this.map.addSource('powerplantSource_Coal', {\n                    type: 'geojson',\n                    data: coalData,\n                    cluster: false\n                })\n\n                this.map.addSource('powerplantSource_Solar', {\n                    type: 'geojson',\n                    data: solarData,\n                    cluster: false,\n                    clusterMaxZoom:6,\n                    clusterRadius: 50\n                \n                })\n\n                this.map.addSource('currentFacilities', {\n                    type: 'geojson',\n                    data: currentData\n                })\n              \n                this.map.addLayer({\n                    id: 'unclusters_solar',\n                    type: 'circle',\n                    source: 'powerplantSource_Solar',\n                    paint: {\n                        \n                        'circle-color': [\n                            \"rgb\",\n                            255,\n                           [\"get\",\"gValue\"],\n                            62\n\n                        ], //\"#ffc83e\",\n                        'circle-opacity': 0.5,\n                        'circle-stroke-color': \"#ffc83e\",\n                        'circle-stroke-opacity': 1,\n                        'circle-stroke-width': 0.5,\n                        'circle-radius':  {\n                            property: 'capacity',\n                    //  //      type: 'exponential',\n                    //        base: 2,\n                            stops: [\n                                [{zoom: 3, value: 1}, 1],\n                                [{zoom: 3, value: 18}, 10],\n                                [{zoom: 4.5, value: 1}, 3],\n                                [{zoom: 4.5, value: 18}, 15],\n                                [{zoom: 7, value: 1}, 5],\n                                [{zoom: 7, value: 18}, 20],\n                                [{zoom: 10, value: 1}, 10],\n                                [{zoom: 10, value: 18}, 25]\n                       \n                            ]\n                        }\n                        \n                    },\n\n                    'filter': ['all', this.m_filterStartYear, this.m_filterEndYear, this.m_filterType, ['!', ['has', 'point_count']]]\n                });\n                this.map.addLayer({\n                    id: 'allpowerplants',\n                    type: 'circle',\n                    source:\"currentFacilities\",\n                    paint: {\n                    'circle-radius': {\n                        property: 'capacity',\n                      //  type: 'exponential',\n                      //  base: 2,\n                        stops: [\n                        [{zoom: 3, value: 1}, 1],\n                        [{zoom: 3, value: 1000}, 6],\n                        [{zoom: 4.5, value: 1}, 3],\n                        [{zoom: 4.5, value: 1000}, 18],\n                        [{zoom: 7, value: 1}, 18],\n                        [{zoom: 7, value: 1000}, 42],\n                        [{zoom: 10, value: 1}, 12],\n                        [{zoom: 10, value: 1000}, 54]\n                        ]\n                    },\n                    'circle-color': [\n                        'match',\n                        ['get', 'type'],\n                        \"Coal\", \"#ced1cc\",\n                        \"Storage\", \"#4e80e5\",\n                        \"Solar\", \"#ffc83e\",\n                        \"Hydro\", \"#43cfef\",\n                        \"Wind\", \"#00a98e\",\n                        \"Biomass\", \"#A7B734\",\n                        \"Solar2\", \"#ea545c\",\n                        \"Gas\", \"#cc9b7a\",\n                        \"Waste\", \"#6b4b06\",\n                        /* other */ '#ccc'\n                    ],\n                    'circle-opacity': 0.3,\n                    'circle-stroke-color':  [\n                        'match',\n                        ['get', 'type'],\n                        \"Coal\", \"#ced1cc\",\n                        \"Storage\", \"#4e80e5\",\n                        \"Solar\", \"#ffc83e\",\n                        \"Hydro\", \"#43cfef\",\n                        \"Wind\", \"#00a98e\",\n                        \"Biomass\", \"#A7B734\",\n                        \"Solar2\", \"#ea545c\",\n                        \"Gas\", \"#cc9b7a\",\n                        \"Waste\", \"#6b4b06\",\n                         /*other,*/  '#ccc' \n                    ],\n                        'circle-stroke-opacity': 1,\n                        'circle-stroke-width': 0.5,\n                    },\n                    'filter': ['all', this.m_filterStartYear, this.m_filterEndYear, this.m_filterType]\n                });\n\n                this.map.addLayer({\n                    id: 'unclusters_coal',\n                    type: 'circle',\n                    source: 'powerplantSource_Coal',\n                    paint: {\n                        'circle-radius': {\n                            property: 'capacity',\n                            type: 'exponential',\n                            base: 2,\n                            stops: [\n                                [{zoom: 2, value: 1}, 1],\n                                [{zoom: 2, value: 2500}, 6],\n                                [{zoom: 4.5, value: 1}, 3],\n                                [{zoom: 4.5, value: 2500}, 20],\n                                [{zoom: 8, value: 1}, 6],\n                                [{zoom: 8, value: 2500}, 32],\n                                [{zoom: 12, value: 1}, 9],\n                                [{zoom: 12, value: 2500}, 56],\n                                [{zoom: 15, value: 1}, 12],\n                                [{zoom: 15, value: 2500}, 60]\n                                ]\n                        },\n                        'circle-color':  \"#404040\",\n                        'circle-opacity': 0.3,\n                        'circle-stroke-color': \"#404040\",\n                        'circle-stroke-opacity': 1,\n                        'circle-stroke-width': 0.5\n                    },\n                    'filter': ['all', this.m_filterStartYear, this.m_filterEndYear, this.m_filterType, ['!', ['has', 'point_count']]]\n               //     'filter': ['!', ['has', 'point_count']]\n                });\n                this.map.addLayer({\n                    id: 'clusters_solar',\n                    type: 'circle',\n                    source: 'powerplantSource_Solar',\n                    filter: [\"all\", [ 'has', 'point_count'],  this.m_filterStartYear, this.m_filterEndYear, this.m_filterType ],\n                    \n                    paint: {\n                       \n                        'circle-color': \"#ffc83e\",\n                        'circle-radius': [\n                            'step',\n                            ['get', 'point_count'],\n                            2,\n                            50,\n                            20,\n                            100,\n                            50\n                        ]\n                    }\n                });\n\n            })\n            var self = this\n\n            const tooltip = new mapboxgl.Marker(this.tooltipContainer, {\n                offset: [-140, 0]\n            }).setLngLat([0, 0]).addTo(this.map);\n\n            this.map.on('mouseenter', 'unclusters_coal', function (e) {\n                // Change the cursor style as a UI indicator.\n                //    console.log(\"enter: \" + e.features[0].properties.site)\n                tooltip.setLngLat(e.lngLat);\n                self.grump = e.features[0]\n                self.map.getCanvas().style.cursor = 'pointer';\n                self.drawPopup(true)\n\n            })\n\n            this.map.on('mousemove', 'unclusters_coal', function (e) {\n                tooltip.setLngLat(e.lngLat);\n                self.grump = e.features[0]\n                self.map.getCanvas().style.cursor = 'pointer';\n                self.drawPopup(true)\n\n            })\n\n            this.map.on('mouseleave', 'unclusters_coal', function (e) {\n\n                self.map.getCanvas().style.cursor = '';\n                self.drawPopup(false)\n            });\n\n            this.map.on('mouseenter', 'unclusters_coal', function (e) {\n                // Change the cursor style as a UI indicator.\n                //    console.log(\"enter: \" + e.features[0].properties.site)\n                tooltip.setLngLat(e.lngLat);\n                self.grump = e.features[0]\n                self.map.getCanvas().style.cursor = 'pointer';\n                self.drawPopup(true)\n\n            })\n\n            this.map.on('mousemove', 'unclusters_coal', function (e) {\n                tooltip.setLngLat(e.lngLat);\n                self.grump = e.features[0]\n                self.map.getCanvas().style.cursor = 'pointer';\n                self.drawPopup(true)\n\n            })\n\n            this.map.on('mouseleave', 'unclusters_solar', function (e) {\n\n                self.map.getCanvas().style.cursor = '';\n                self.drawPopup(false)\n            });\n\n            this.map.on('mouseenter', 'unclusters_solar', function (e) {\n                // Change the cursor style as a UI indicator.\n                //    console.log(\"enter: \" + e.features[0].properties.site)\n                tooltip.setLngLat(e.lngLat);\n                self.grump = e.features[0]\n                self.map.getCanvas().style.cursor = 'pointer';\n                self.drawPopup(true)\n\n            })\n\n            this.map.on('mousemove', 'unclusters_solar', function (e) {\n                tooltip.setLngLat(e.lngLat);\n                self.grump = e.features[0]\n                self.map.getCanvas().style.cursor = 'pointer';\n                self.drawPopup(true)\n\n            })\n\n            this.map.on('mouseleave', 'unclusters_solar', function (e) {\n\n                self.map.getCanvas().style.cursor = '';\n                self.drawPopup(false)\n            });\n\n            this.map.on('mouseenter', 'allpowerplants', function (e) {\n                // Change the cursor style as a UI indicator.\n                //    console.log(\"enter: \" + e.features[0].properties.site)\n                tooltip.setLngLat(e.lngLat);\n                self.grump = e.features[0]\n                self.map.getCanvas().style.cursor = 'pointer';\n                self.drawPopup(true)\n\n            })\n\n            this.map.on('mousemove', 'allpowerplants', function (e) {\n                tooltip.setLngLat(e.lngLat);\n                self.grump = e.features[0]\n                self.map.getCanvas().style.cursor = 'pointer';\n                self.drawPopup(true)\n\n            })\n\n            this.map.on('mouseleave', 'allpowerplants', function (e) {\n\n                self.map.getCanvas().style.cursor = '';\n                self.drawPopup(false)\n            });\n\n            this.map.on('zoomend', function(e){\n                self.setState({\n                    zoomlevel: self.map.getZoom()\n                })\n            })\n            // Change the cursor style as a UI indicator.\n            this.map.getCanvas().style.cursor = 'pointer';\n            this.m_initiated = true;\n            this.setState({\n                zoomlevel: this.map.getZoom()\n            })\n        }\n\n    }\n\n    setTooltip(show, color, name, capacity, open, decom, type2) {\n\n        if (show) {\n\n            ReactDOM.render(\n                React.createElement(\n                    PopupContent, {\n                    color, name, capacity, open, decom, type2\n                }\n                ),\n                this.tooltipContainer\n            )\n        } else {\n\n            ReactDOM.unmountComponentAtNode(this.tooltipContainer)\n        }\n    }\n\n    componentDidUpdate(prevState) {\n\n        //   console.log(this.props.filter)\n        if (this.props.activeYear !== this.state.currentYear) {\n            this.setState({\n                currentYear: this.props.activeYear\n\n            })\n            this.m_filterStartYear = ['<=', ['number', ['get', 'yearStart']], this.props.activeYear]\n            this.m_filterEndYear = ['>=', ['number', ['get', 'yearEnd']], this.props.activeYear]\n            this.updateFilters()\n        }\n        if (this.props.types !== this.state.rawtypes) {\n            this.m_filterType = [\"any\"]\n            //create the filter syntax fromthe actionFilter provided\n            for (var i = 0; i < this.props.types.length; i++) {\n                if (this.props.types[i].active)\n                    this.m_filterType.push([\"==\", [\"get\", \"type\"], this.props.types[i].type])\n            }\n\n            this.setState({\n\n                rawtypes: this.props.types\n            })\n            this.updateFilters()\n        }\n\n        this.init()\n    }\n    componentDidMount() {\n        this.tooltipContainer = document.createElement('div');\n        this.init()\n    }\n    drawPopup(show) {\n\n        var o = this.grump\n        var name = o.properties.site;\n        var capacity = o.properties.capacity;\n        var open = o.properties.yearOpen;\n        var decom = o.properties.yearEnd;\n        var plantColor = this.m_colors[o.properties.type];\n        var type2 = o.properties.type2;\n        var type = o.properties.type;\n        this.setTooltip(show, plantColor, name, capacity, open, type===\"Solar\" ? 9999 : decom, type=== \"Solar\" ? type : type2)\n\n        // Ensure that if the map is zoomed out such that multiple\n        // copies of the feature are visible, the popup appears over the copy being pointed to.\n        //   while (Math.abs(e.lngLat.lng - coordinates[0]) > 180) {\n        //      coordinates[0] += e.lngLat.lng > coordinates[0] ? 360 : -360;\n        // }\n\n        // Populate the popup and set its coordinates\n        // based on the feature found.\n        //  this.popup.setLngLat(coordinates)\n        //      .setHTML(<PopupContent color={plantColor} name={name} capacity={this.roundToOne(capacity)} lowCarbon={lowCarbon} operator={operator} open={open} fuel={this.getFuel(type, fuelDetail)} chp={chp} />)\n        //      .addTo(this.map);\n    }\n\n    setFilterType(filtertype) {\n        if (this.map.isStyleLoaded()) {\n            this.m_filterType = [\"all\", [\"==\", [\"get\", \"type\"], filtertype]]\n            this.updateFilters()\n        }\n    }\n\n    updateFilters() {\n        if (this.map.isStyleLoaded()) {\n            // map.setFilter('powerplants', ['all', filterOperator, filterType, filterStartYear, filterEndYear, filterSite, filterCapacity]);\n            this.map.setFilter('unclusters_coal', ['all', this.m_filterStartYear, this.m_filterEndYear, this.m_filterType, ['!', ['has', 'point_count']]] )\n           \n            this.map.setFilter('unclusters_solar', ['all', this.m_filterStartYear, this.m_filterEndYear, this.m_filterType, ['!', ['has', 'point_count']]])\n            this.map.setFilter('clusters_solar', ['all', this.m_filterStartYear, this.m_filterEndYear, this.m_filterType,['has','point_count']])\n            this.map.setFilter('allpowerplants',['all', this.m_filterStartYear, this.m_filterEndYear, this.m_filterType])\n        }\n    }\n\n    getFuel = (type, fuelDetail) => {\n        if (fuelDetail === \"-\") {\n            return type\n        } else if (type === \"Wind\" || type === \"Hydro\") {\n            return fuelDetail\n        } else {\n            return type + \", \" + fuelDetail\n        }\n    }\n\n    roundToOne = (capacity) => {\n        return +(Math.round(capacity + \"e+1\") + \"e-1\");\n    }\n\n    render() {\n        return (\n            <div>\n                {this.props.debug===true ? <div className=\"Debug\">Debug: zoom level: {this.state.zoomlevel} </div> : \"\" }\n            <div style={{ height: this.props.height }} ref={el => this.mapContainer = el} className=\"mapContainer topDistance\" id=\"map\" />\n            </div>\n        )\n    }\n\n}\nconst PopupContent = ({ color, name, capacity, open, decom, type2 }) => (\n\n    <div className={`colour-key popupDiv`}>\n        <h3 className=\"popupHeading\" style={{ color: color }}> {name}</h3>\n        <div className=\"popupInfo\" style={{ 'backgroundColor': color }} >\n            <p><span className=\"label-title\">Capacity: </span>{capacity}<span className=\"units\">  MW</span></p>\n            {type2 !== \"\" ? <p><span className=\"label-title\">Type: </span>{type2}</p> : \"\"}\n            {open !== undefined ? <p><span className=\"label-title\">Year opened: </span>  {open} </p> : \"\"}\n             {decom !== 9999 ?<p><span className=\"label-title\"> Decomission: </span> {decom} </p> : \"\"}\n           \n        </div>\n    </div>\n)\n\n","// with help from https://bl.ocks.org/reinson/166bae46dd106b45cf2d77c7802768ca\n\n// zero data converted to 0.001 to avoid messing up the order of the colours if bars are added/removed\nimport React, { PureComponent } from 'react';\nimport {\n  Bar\n} from 'react-chartjs-2';\n\nimport stacked100 from \"chartjs-plugin-stacked100\"\n\nexport default class StackedBarChart extends PureComponent {\n  m_colors = {\n    \"Coal\": \"#91908d\",\n    \"Solar\": \"#ffc83e\",\n    \"Hydro\": \"#43cfef\",\n    \"Wind\": \"#00a98e\",\n    \"Waste\": \"#6b4b06\",\n    \"Solar2\": \"#ea545c\",\n    \"Gas\": \"#cc9b7a\"\n  }\n\n  /*\n     \"Coal\", \"#ced1cc\",\n                          \"Storage\", \"#4e80e5\",\n                          \"Solar\", \"#ffc83e\",\n                          \"Hydro\", \"#43cfef\",\n                          \"Wind\", \"#00a98e\",\n                          \"Biomass\", \"#A7B734\",\n                          \"Solar2\", \"#ea545c\",\n                          \"Gas\", \"#cc9b7a\",\n                          \"Waste\", \"#6b4b06\",*/\n\n  state = {\n    data: {\n      labels: [\"%\"],\n      datasets: [{\n        label: 'Employee',\n        backgroundColor: \"#caf270\",\n        data: [12, 59, 5, 56, 58, 12, 59, 87, 45],\n      }]\n    },\n    percentages: null\n  }\n  componentDidUpdate() {\n\n    if(this.props.percentages!== this.state.percentages){\n    console.log(this.props.percentages)\n    var datasets = []\n    for (var i = 0; i < this.props.percentages.length; i++) {\n      var newObj = {}\n      newObj.label = this.props.percentages[i].type\n      newObj.backgroundColor = this.m_colors[newObj.label]\n      newObj.data = []\n      newObj.data[0] = this.props.percentages[i].percentage\n      datasets.push(newObj)\n    }\n\n    this.setState({\n      data: {\n        labels: [\"capacity\"],\n        datasets: datasets\n      },\n      percentages: this.props.percentages\n    })\n  }\n  }\n\n  componentDidMount(){\n\n    var datasets = []\n    for (var i = 0; i < this.props.percentages.length; i++) {\n      var newObj = {}\n      newObj.label = this.props.percentages[i].type\n      newObj.backgroundColor = this.m_colors[newObj.label]\n      newObj.data = []\n      newObj.data[0] = this.props.percentages[i].percentage\n      datasets.push(newObj)\n    }\n\n    this.setState({\n      data: {\n        \n        datasets: datasets\n      },\n      percentages: this.props.percentages\n    })\n  }\n  render() {\n    return (\n    \n       \n        <Bar\n          data={this.state.data}\n          width={this.props.width}\n          height={this.props.height}\n          options={{\n            tooltips: {\n              \n              displayColors: false,\n              callbacks: {\n                title: function() {},\n                \n                label: function(tooltipItem, data) {\n                  var label = data.datasets[tooltipItem.datasetIndex].label || '';\n                 \n                  label +=\": \" + tooltipItem.yLabel;\n                  return  label + \"%\";\n              }\n             }\n            },\n            scales: {\n              xAxes: [{\n                stacked: true,\n                gridLines: {\n                  display: false,\n                }\n              }],\n              yAxes: [{\n                stacked: true,\n                gridLines: {\n                  display: true,\n                },\n                \n                position: 'right',\n                ticks: {\n                  beginAtZero: true,\n                  max: 100,\n                  stepSize: 20\n                }\n               \n              }]\n            },\n            layout: {\n              padding: {\n                  left: 20\n              }\n          },\n            responsive: true,\n            maintainAspectRatio: false,\n            legend: { display: false }\n          }}\n        />\n     \n    );\n  }\n}\n\n\n\n","import React, {Component} from \"react\";\nimport StackedBarChart from \"./StackedBarChart\";\n\nclass StackedBar extends Component {\n    render() {\n        return (\n            <div className=\"mapBorder\" style={{ height: this.props.height }} id=\"stackedBar\">\n                <StackedBarChart percentages={this.props.percentages} width={85} height={this.props.height} />\n            </div>\n        )\n    }\n}\n\nexport default StackedBar;\n","import ScrollIntoView from \"react-scroll-into-view\";\nimport React from \"react\";\n\nconst NavMenuItem = ({ id, name, activeId }) => (\n\n    <ScrollIntoView\n        selector={`#section${name}_id_p0`}\n        alignToTop={false} >\n        <div className={`navItem ${id === activeId ? \"navItemActive\" : \"\"} `}> {name} </div>\n    </ScrollIntoView>\n)\n\nexport default NavMenuItem;\n","import React, {Component} from \"react\";\n\nclass NavMenuTypeItem extends Component {\n    handleClick = () => {\n        this.props.onClickA(this.props.type);\n    }\n\n    render() {\n        return (\n            <div onClick={this.handleClick} className={`navItem navItemColor ${this.props.active ? \"navItemActive_\" + this.props.type : \"\"}`}> {this.props.type} </div>\n\n        );\n    }\n}\n\nexport default NavMenuTypeItem;\n","import React, {Component} from \"react\";\nimport * as d3 from \"d3\";\nimport stackedData from \"../AUSdata/yearDistribution.csv\";\nimport dataSolar from \"../AUSdata/powerStations_solar.json\";\nimport sectiondata from \"../playdata/sections.json\";\nimport StoryPanel from \"./StoryPanel\";\nimport MapVisualization from \"./MapVisualization\";\nimport dataCoal from \"../AUSdata/powerStations_coal.json\";\nimport dataWind from \"../AUSdata/facility_wind.json\";\nimport dataHydro from \"../AUSdata/facility_hydro.json\"\nimport dataSolar2 from \"../AUSdata/facility_solar2.json\"\nimport currentData from \"../AUSdata/facility_registry.json\";\nimport StackedBar from \"./StackedBar\";\nimport NavMenuItem from \"./NavMenuItem\";\nimport NavMenuTypeItem from \"./NavMenuTypeItem\";\n\nclass ScrollyTeller extends Component {\n    m_debug= true\n    m_percentageCalcs = []\n    updateDimensions = () => {\n        this.setState({ width: window.innerWidth, height: window.innerHeight, panelHeight: window.innerHeight - 100 });\n\n    };\n\n    //  m_mapfilter = null;\n    state = {\n        sections: [],\n        width: 0,\n        height: 0,\n        //the years should be read from a file with their corresponding html content\n        // sorteddata: [],\n        activeId: 0,\n        panelHeight: 800,\n        types: [{ \"type\": \"Coal\", \"active\": true },\n        { \"type\": \"Solar\", \"active\": true },\n        { \"type\": \"Solar2\", \"active\": true },\n        { \"type\": \"Hydro\", \"active\": true },\n        { \"type\": \"Waste\", \"active\": true },\n        { \"type\": \"Storage\", \"active\": true },\n        { \"type\": \"Wind\", \"active\": true },\n        { \"type\": \"Gas\", \"active\": true }],\n\n        percentages: [\n            { \"type\": \"Coal\", \"percentage\": 45 },\n            { \"type\": \"Solar\", \"percentage\": 20 },\n            { \"type\": \"Solar2\", \"percentage\": 10 },\n            { \"type\": \"Hydro\", \"percentage\": 5 },\n            { \"type\": \"Waste\", \"percentage\": 5 },\n            { \"type\": \"Wind\", \"percentage\": 5 },\n            { \"type\": \"Gas\", \"percentage\": 15 }\n        ]\n    }\n    panelChanged = false\n    // m_mapFunctions = null\n    //\"Facility Name\", \"Status\", \"Region\", \"Technology\", \"Generator Capacity (MW)\", \"Latitude\", \"Longitude\"\n\n\n    GetNewPercentages = (year) => {\n        console.log(year)\n\n        if (year < this.m_percentageCalcs[0].year || year === undefined) {\n\n               return this.m_percentageCalcs[0].vals\n\n        } else if (year> this.m_percentageCalcs[this.m_percentageCalcs.length - 1].year) {\n\n            return    this.m_percentageCalcs[this.m_percentageCalcs.length - 1].vals\n\n        } else {\n                var i=0\n                while(this.m_percentageCalcs[i].year < year){\n\n                    i++\n                }\n                console.log(this.m_percentageCalcs[i].vals)\n                return  this.m_percentageCalcs[i].vals\n        }\n\n    }\n\n    prepPercentages = (data) => {\n      //  console.log(data)\n        //m_percentageCalcs\n        /*0: {Year: \"1989\", Coal: \"121167.00\", Solar: \"\", Solar2: \"\", Hydro: \"14880.00\", …}\n1: {Year: \"1990\", Coal: \"125559.00\", Solar: \"\", Solar2: \"\", Hydro: \"16103.00\", …}\n2: {Year: \"1991\", Coal: \"128884.10\", Solar: \"10.90\", Solar2: \"\", Hydro: \"15768.00\", …}\n3: {Year: \"1992\", Coal: \"131120.70\", Solar: \"13.30\", Solar2: \"\", Hydro: \"16953.00\", …}\n4: {Year: \"1993\", Coal: \"135434.10\", Solar: \"15.90\", Solar2: \"\", Hydro: \"16649.00\", …}\n5: {Year: \"1994\", Coal: \"138354.10\", Solar: \"18.90\", Solar2: \"\", Hydro: \"16239.00\", …}*/\n        var row, sum\n        var arr = []\n        for (var i = 0; i < data.length; i++) {\n            arr = []\n            sum = 0\n            row = data[i]\n            row.Coal = parseFloat(row.Coal)\n            row.Solar = parseFloat(row.Solar)\n            row.Solar2 = parseFloat(row.Solar2)\n            row.Gas = parseFloat(row.Gas)\n            row.Waste = parseFloat(row.Waste)\n            row.Hydro = parseFloat(row.Hydro)\n            row.Wind = parseFloat(row.Wind)\n            if (!isNaN(row.Coal)) {\n                sum += row.Coal\n            }\n            if (!isNaN(row.Solar)) {\n                sum += row.Solar\n            }\n            if (!isNaN(row.Solar2)) {\n                sum += row.Solar2\n            }\n            if (!isNaN(row.Gas)) {\n                sum += row.Gas\n            }\n            if (!isNaN(row.Waste)) {\n                sum += row.Waste\n            }\n            if (!isNaN(row.Hydro)) {\n                sum += row.Hydro\n            }\n            if (!isNaN(row.Wind)) {\n                sum += row.Wind\n            }\n         //   console.log(row)\n            // sum = parseFloat(row.Coal) + parseFloat(row.Solar) + parseFloat(row.Solar2) + parseFloat(row.Hydro) + parseFloat(row.Gas) + parseFloat(row.Waste) + parseFloat(row.Wind)\n\n            arr.push({ \"type\": \"Coal\", \"percentage\": +parseFloat( (row.Coal) / sum * 100 ).toFixed(2)})\n            arr.push({ \"type\": \"Solar\", \"percentage\": +parseFloat((row.Solar) / sum * 100).toFixed(2) })\n            arr.push({ \"type\": \"Solar2\", \"percentage\": +parseFloat((row.Solar2) / sum * 100).toFixed(2) })\n            arr.push({ \"type\": \"Hydro\", \"percentage\": +parseFloat((row.Hydro) / sum * 100).toFixed(2) })\n            arr.push({ \"type\": \"Waste\", \"percentage\": +parseFloat((row.Waste) / sum * 100).toFixed(2) })\n            arr.push({ \"type\": \"Wind\", \"percentage\": +parseFloat((row.Wind) / sum * 100 ).toFixed(2)})\n            arr.push({ \"type\": \"Gas\", \"percentage\": +parseFloat((row.Gas) / sum * 100).toFixed(2) })\n\n            this.m_percentageCalcs.push({ \"year\": parseFloat(row.Year), vals: arr })\n        }\n       // console.log(this.m_percentageCalcs)\n       // this.updatePercentages(1960)\n       this.setState({\n\n        percentages: this.GetNewPercentages( this.state.sections[0].year)\n\n    })\n    }\n\n    UNSAFE_componentWillMount = function () {\n        window.addEventListener('resize', this.updateDimensions);\n        this.updateDimensions()\n\n        d3.csv(stackedData).then(this.prepPercentages);\n\n        /* make solar not disappear because of dataset...*/\n        var postcode = \"\";\n        var i\n        for( i = 0; i <dataSolar.features.length; i ++){\n            var obj = dataSolar.features[i]\n            if ( obj.properties.site !== postcode) {\n                if(i>0){\n                    dataSolar.features[i-1].properties.yearEnd=9999\n                }\n                postcode = obj.properties.site\n            }\n\n        }\n\n        for ( i = 0; i < sectiondata.sections.length; i++) {\n            sectiondata.sections[i].renderparagraphs = this.createPanelContent(sectiondata.sections[i].year, sectiondata.sections[i].paragraphs)\n            //     console.log(sectiondata.sections[i].renderparagraphs)\n        }\n        //  console.log(sectiondata.sections[4].renderparagraphs)\n        //read the content from file.\n        this.setState({\n            sections: sectiondata.sections\n        })\n\n        //  console.log(sectiondata.sections)\n        var val;\n        for (var j = 0; j < dataSolar.features.length; j++) {\n\n             val = dataSolar.features[j].properties.capacity;\n            if(val > 15000 ){\n                dataSolar.features[j].properties.gValue = 20\n            } else if( val < 200) {\n                dataSolar.features[j].properties.gValue = 200;\n            } else {\n\n                dataSolar.features[j].properties.gValue =  300 - (Math.trunc((val - 200) * (200 - 50)/(15000-200) + 50))\n           //     console.log(dataSolar.features[j].properties.capacity);\n\n            }\n            dataSolar.features[j].properties.capacity = (dataSolar.features[j].properties.capacity /= 1000).toFixed(2);\n\n\n        }\n\n    }\n\n    componentWillUnmount() {\n        window.removeEventListener('resize', this.updateDimensions);\n    }\n    allPanels = []\n    setActiveID = (id) => {\n        this.setState({\n            activeId: id,\n\n\n        })\n\n        if(this.m_percentageCalcs!==undefined && this.m_percentageCalcs.length > 0){\n            this.setState({\n\n                percentages: this.GetNewPercentages( this.state.sections[id].year)\n\n            })\n        }\n      //  this.updatePercentages(this.state.sections[id].year)\n        //this.m_mapFunctions.setFilterYearStart(this.state.years[id])\n        //   this.m_mapFunctions.setFilterStartEnd(this.state.sections[id].year)\n\n        //  this.updatePercentages()\n        //in each year i want to display plants that HAVE STARTED but NOT YET ENDED\n    }\n\n    createPanelContent(year, paragraphs) {\n\n        //read the text from somewhere based on the given year\n        var result = [];\n        var filter = \"\";\n        var key = \"\"\n        for (var i = 0; i < paragraphs.length; i++) {\n            key = year + \"_\" + i\n            //check for features like links, if its a link, replace the \"text\" with a hyperlinnk to the \"url\"\n            if (paragraphs[i].features) {\n                for (var j = 0; j < paragraphs[i].features.length; j++) {\n                    var feature = paragraphs[i].features[j]\n                    if (feature.type === \"link\") {\n                        paragraphs[i].text = paragraphs[i].text.replace(feature.text, '<a href=\"' + feature.url + '\" target=\"_blank\">' + feature.text + '</a>')\n                        //                console.log(paragraphs[i].text)\n                    }\n                }\n            }\n            //if actions aredefined, they are added to the element here.\n            if (paragraphs[i].actions) {\n                for (j = 0; j < paragraphs[i].actions.length; j++) {\n                    var action = paragraphs[i].actions[j]\n                    if (action.highlight) {\n                        if (action.highlight.type === \"type\") {\n                            filter = {\n\n                                \"action\": this.setActiveMulti,\n                                \"objects\": []\n                            }\n                        } else if (action.highlight.type === \"plant\") {\n                            filter = {\n\n                                \"action\": this.setActiveName,\n                                \"objects\": []\n                            }\n                        }\n                        //highlight means highlight the words in the text with a class of the same name, and filter things on the map of this name\n                        for (var k = 0; k < action.highlight.keywords.length; k++) {\n                            paragraphs[i].text = paragraphs[i].text.replace(action.highlight.keywords[k], \"<span class='\" + action.highlight.keywords[k] + \"'>\" + action.highlight.keywords[k] + \"</span>\")\n                            filter.objects.push(this.cap(action.highlight.keywords[k]))\n\n                            //capitalise first letter otherwise the filter breaks\n                        }\n                    }\n                }\n            }\n\n            result.push(\n                <div content={paragraphs[i]} id={key} actionFilter={filter} />\n            )\n        }\n        // console.log(result)\n        return result\n\n    }\n\n    //gets called from child components or when the user clicked the type nav menu. updates state of that menu accordingly, also when a scrolltrigger (de)activated a type\n    setActiveMulti = (types) => {\n\n        var arr = null\n        if (types === null) {\n            arr = [{ \"type\": \"Coal\", \"active\": true },\n            { \"type\": \"Gas\", \"active\": true },\n            { \"type\": \"Hydro\", \"active\": true },\n            { \"type\": \"Wind\", \"active\": true },\n            { \"type\": \"Waste\", \"active\": true },\n            { \"type\": \"Solar\", \"active\": true },\n            { \"type\": \"Solar2\", \"active\": true }]\n\n        } else {\n            arr = [{ \"type\": \"Coal\", \"active\": false },\n            { \"type\": \"Gas\", \"active\": false },\n            { \"type\": \"Hydro\", \"active\": false },\n            { \"type\": \"Wind\", \"active\": false },\n            { \"type\": \"Waste\", \"active\": false },\n            { \"type\": \"Solar\", \"active\": false },\n            { \"type\": \"Solar2\", \"active\": true }]\n            for (var i = 0; i < arr.length; i++) {\n                for (var j = 0; j < types.length; j++) {\n                    if (arr[i].type === types[j]) {\n                        arr[i].active = true\n                        break;\n                    }\n                }\n            }\n\n        }\n        this.setState({\n            types: arr\n        })\n    }\n\n    setActive = (ttype, active) => {\n        //  console.log(index)\n        this.setState(state => {\n            const types = state.types.map((type, i) => {\n                if (type === ttype) {\n                    return { \"type\": type.type, \"active\": active }\n                } else {\n                    return type;\n                }\n            });\n            return {\n                types\n            };\n        })\n    }\n\n    setActiveName = (name) => {\n\n    }\n    toggleActive = (ttype) => {\n       // console.log(ttype)\n        this.setState(state => {\n            const types = state.types.map((type) => {\n                if (type.type === ttype) {\n                    return { \"type\": type.type, \"active\": !type.active }\n                } else {\n                    return type;\n                }\n            });\n            return {\n                types\n            };\n        })\n    }\n    //capitalise the first letter of  string\n    cap(lower) {\n        return lower.replace(/^\\w/, c => c.toUpperCase());\n    }\n    render() {\n        return (\n            <div className=\"App\">\n                <div className=\"navbar\" id=\"yearNav\">\n                    {this.state.sections.map(\n                        (section, i) =>\n                            <NavMenuItem\n                                key={i}\n                                id={i}\n                                name={section.year}\n                                activeId={this.state.activeId}\n                            />\n                    )}\n                </div>\n                <div className=\"navbar navbar_right\" id=\"typeNav\">\n                    <span className=\"typeSelectionLabel\">Type selection</span>\n                    {this.state.types.map(\n                        (type, i) =>\n                            <NavMenuTypeItem\n                                key={i}\n                                onClickA={this.toggleActive}\n                                type={type.type}\n                                active={type.active}\n                            />\n                    )}\n                </div>\n                <div className=\"MainContainer\">\n                    {/*  <StackedBar  percentages={this.state.percentages} height={this.state.panelHeight}/>--> */}\n                    <div className=\"Panels topDistance\" style={{ height: this.state.panelHeight }}>\n\n                        {this.state.sections.map(\n                            (section, i) =>\n\n                                <StoryPanel\n                                    key={i}\n                                    id={i}\n                                    app={this}\n                                    activeID={this.state.activeId} //the Storypanels figure out if they are the active panel and display accordingly\n                                    title={section.year}\n                                    anchorname={\"section\" + section.year}\n                                    paragraphs={section.renderparagraphs}\n                                />\n                        )}\n                    </div>\n                    <StackedBar height={this.state.panelHeight-70}\n                                percentages={this.state.percentages} />\n                    <MapVisualization types={this.state.types}\n                                      coalData={dataCoal}\n                                      debug={ this.m_debug}\n                                      currentData={currentData}\n                                      solarData={dataSolar}\n                                      height={this.state.panelHeight}\n                                      activeYear={this.state.sections !== undefined ? this.state.sections[this.state.activeId].year : \"1950\"} />\n\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default ScrollyTeller;\n","import './App.css';\nimport React from 'react';\nimport ScrollyTeller from \"./components/ScrollyTeller\";\n\nfunction App() {\n    return <>\n        <ScrollyTeller />\n    </>;\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport App from \"./App\";\nimport './css/index.css';\nimport './css/responsive.css'\n\nReactDOM.render(<App />, document.getElementById('root'));\n","module.exports = __webpack_public_path__ + \"static/media/yearDistribution.713f33ce.csv\";"],"sourceRoot":""}